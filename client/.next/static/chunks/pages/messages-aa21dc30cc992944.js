(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[313],{3324:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return A},default:function(){return L}});var a=n(9499),s=n(29),i=n(6687),o=n(7794),r=n.n(o),l=n(711),d=n(508),c=n(8338),u=n(2287),g=n(7294),p=n(7711),x=n(8187),f=n(1526),h=n(566),m=n(7517),b=n(3920),Z=n(6552),y=n(5893),w=d.ZP.div.withConfig({displayName:"Textarea__TextareaContainer",componentId:"sc-14wqn48-0"})(["@media ","{display:flex;width:100%;flex-direction:column;align-items:flex-start;gap:8px;}"],c.Z.XS),j=d.ZP.label.withConfig({displayName:"Textarea__TextareaLabel",componentId:"sc-14wqn48-1"})(["@media ","{display:flex;flex-direction:row;gap:4px;font-size:16px;font-weight:400;line-height:19px;color:",";}"],c.Z.XS,u.Z.neutral700),v=d.ZP.span.withConfig({displayName:"Textarea__RequiredAsterisk",componentId:"sc-14wqn48-2"})(["@media ","{color:",";}"],c.Z.XS,u.Z.error500),C=d.ZP.textarea.withConfig({displayName:"Textarea__TextareaTextarea",componentId:"sc-14wqn48-3"})(["@media ","{display:flex;height:100px;padding:12px;box-sizing:border-box;align-items:flex-start;align-self:stretch;border-radius:8px;background:",";color:",";border:none;outline:none;&:focus{border:1px solid ",";color:",";}&::placeholder{color:",";}}"],c.Z.XS,u.Z.neutral100,u.Z.neutral400,u.Z.primary400,u.Z.primary400,u.Z.neutral300),S=g.forwardRef(function(e,t){var n=e.label,a=e.value,s=e.onChange,i=e.required,o=e.placeholder,r=e.disabled;return(0,y.jsxs)(w,{children:[n&&(0,y.jsxs)(j,{children:[i&&(0,y.jsx)(v,{children:"*"}),n]}),(0,y.jsx)(C,{value:a,onChange:function(e){return s(e.target.value)},required:i,placeholder:o,disabled:r,ref:t})]})});S.displayName="Textarea";var T=n(5030),_=d.ZP.div.withConfig({displayName:"MessageCell__MessageCellContainer",componentId:"sc-1gn6bj9-0"})(["@media ","{display:flex;width:100%;flex-direction:column;align-items:flex-start;gap:20px;}"],c.Z.XS),M=d.ZP.div.withConfig({displayName:"MessageCell__MessageTop",componentId:"sc-1gn6bj9-1"})(["@media ","{display:flex;gap:24px;width:100%;}"],c.Z.XS),P=d.ZP.div.withConfig({displayName:"MessageCell__HeadingAndSubhead",componentId:"sc-1gn6bj9-2"})(["@media ","{display:flex;flex-direction:column;gap:8px;flex:1 0 0;h4{font-size:24px;font-weight:800;line-height:29px;color:",";}p{font-size:16px;font-weight:500;line-height:19px;color:",";}}@media ","{h4{font-size:32px;font-weight:800;line-height:39px;color:",";}p{font-size:20px;font-weight:500;line-height:24px;color:",";}}"],c.Z.XS,u.Z.neutral600,u.Z.neutral400,c.Z.L,u.Z.neutral600,u.Z.neutral400),N=d.ZP.div.withConfig({displayName:"MessageCell__MessageContainer",componentId:"sc-1gn6bj9-3"})(["@media ","{display:flex;padding:16px;flex-direction:column;gap:16px;border-radius:16px;background:",";width:100%;box-sizing:border-box;}@media ","{padding:20px;}"],c.Z.XS,u.Z.neutral200,c.Z.L),E=d.ZP.div.withConfig({displayName:"MessageCell__TextareaAndButtons",componentId:"sc-1gn6bj9-4"})(["@media ","{display:flex;flex-direction:column;align-items:flex-start;gap:16px;align-self:stretch;flex:1 0 0;}"],c.Z.XS),I=d.ZP.div.withConfig({displayName:"MessageCell__BottomButtons",componentId:"sc-1gn6bj9-5"})(["@media ","{display:flex;flex-direction:column;gap:16px;width:100%;}@media ","{flex-direction:row;gap:12px;width:auto;}"],c.Z.XS,c.Z.S),O=d.ZP.div.withConfig({displayName:"MessageCell__ButtonContainer",componentId:"sc-1gn6bj9-6"})(["@media ","{display:flex;width:100%;}@media ","{width:auto;}"],c.Z.XS,c.Z.S),k=d.ZP.div.withConfig({displayName:"MessageCell__TextMessageTop",componentId:"sc-1gn6bj9-7"})(["@media ","{display:flex;padding:0;margin:0;p{color:",";font-size:16px;font-weight:500;line-height:26px;}}"],c.Z.XS,u.Z.neutral700),D=d.ZP.div.withConfig({displayName:"MessageCell__TextMessageBottom",componentId:"sc-1gn6bj9-8"})(["@media ","{display:flex;flex-direction:column;padding:0;margin:0;p{color:",";font-size:16px;font-weight:500;line-height:26px;}}"],c.Z.XS,u.Z.neutral700),X=function(e){var t,n=e.messageNumberId,a=e.messageTitle,i=e.messageSubtitle,o=e.textMessageDefaultTextStart,d=e.textMessageCustomText,c=e.textMessageDefaultTextEnd1,u=e.textMessageDefaultTextEnd2,p=e.active,f=e.onTriggeredMessageToggleChange,h=e.originalTriggeredMessageValue,m=e.hasPendingMessageChanges,b=e.editingIndex,w=e.setEditingIndex,j=e.index,v=(0,g.useRef)(null),C=(0,g.useState)(!1),X=C[0],z=C[1],V=(0,g.useState)(d),q=V[0],B=V[1],F=(0,g.useState)(q),A=F[0],L=F[1],J=(0,g.useState)(p),R=J[0],W=J[1],U=(0,g.useState)(!1),H=U[0],G=U[1],K=(0,x.o)(function(e){return{showToast:e.showToast}}).showToast;(0,g.useEffect)(function(){G(null!==b)},[b]),(0,g.useEffect)(function(){W(p)},[p]),(0,g.useEffect)(function(){W(h),console.log("isActive state reset to:",h)},[h]),(0,g.useEffect)(function(){if(X){var e;null===(e=v.current)||void 0===e||e.focus()}},[X]);var Q=(t=(0,s.Z)(r().mark(function e(){var t,a;return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={triggeredMessageDetails:{customText:A,triggeredMessageId:n},user:x.o.getState().data},e.prev=2,e.next=5,fetch("http://localhost:5000/update-triggered-message-content",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 5:if(!(a=e.sent).ok){e.next=15;break}return e.next=9,a.json();case 9:e.sent,K("Message updated successfully!","success"),B(A),z(!1),e.next=16;break;case 15:K("Failed to update message.","error");case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),K("Error: Something went wrong!","error");case 21:case"end":return e.stop()}},e,null,[[2,18]])})),function(){return t.apply(this,arguments)});return(0,y.jsxs)(_,{children:[(0,y.jsxs)(M,{children:[(0,y.jsxs)(P,{children:[(0,y.jsx)("h4",{children:a}),(0,y.jsx)(l.Z,{text:i})]}),(0,y.jsx)(T.Z,{active:R,onChange:function(e){W(e),f(j,e)},disabled:H})]}),(0,y.jsxs)(N,{children:[(0,y.jsx)(k,{children:(0,y.jsx)(l.Z,{text:o})}),(0,y.jsxs)(E,{children:[(0,y.jsx)(S,{value:A,onChange:function(e){return L(e)},disabled:!X,ref:v}),(0,y.jsxs)(D,{children:[(0,y.jsx)(l.Z,{text:c}),(0,y.jsx)(l.Z,{text:u})]}),X?(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(I,{children:[(0,y.jsx)(O,{children:(0,y.jsx)(Z.Z,{buttonTypeVariant:"neutral",sizeVariant:"large",label:"Cancel",buttonWidthVariant:"fill",onClick:function(){L(q),z(!1),w(null)}})}),(0,y.jsx)(O,{children:(0,y.jsx)(Z.Z,{buttonTypeVariant:"primary",sizeVariant:"large",label:"Save",buttonWidthVariant:"fill",onClick:function(){B(A),z(!1),Q(),w(null)}})})]})}):(0,y.jsx)(O,{children:(0,y.jsx)(Z.Z,{buttonTypeVariant:H||m?"disabled":"secondary",sizeVariant:"large",label:"Edit Custom Text",buttonWidthVariant:"fill",onClick:function(){m||(z(!0),w(j))},disabled:H||m})})]})]})]})};function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach(function(t){(0,a.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var q=d.ZP.div.withConfig({displayName:"messages__FlexDiv2",componentId:"sc-q8sudu-0"})(["@media ","{display:flex;gap:40px;flex-direction:column;padding:24px 16px;width:100vw;box-sizing:border-box;background:",";}"],c.Z.XS,u.Z.primary100),B=d.ZP.div.withConfig({displayName:"messages__MessagesPageTitle",componentId:"sc-q8sudu-1"})(["@media ","{display:flex;color:",";p{font-size:32px;line-height:39px;font-weight:800;}}@media ","{color:",";p{font-size:40px;line-height:48px;}}@media ","{color:",";p{font-size:48px;line-height:58px;}}"],c.Z.XS,u.Z.neutral700,c.Z.S,u.Z.neutral700,c.Z.L,u.Z.neutral700),F=d.ZP.div.withConfig({displayName:"messages__MessageCellsContainer",componentId:"sc-q8sudu-2"})(["@media ","{display:flex;flex-direction:column;gap:64px;width:100%;}"],c.Z.XS),A=!0,L=function(e){var t=e.triggeredMessagesData,n=(0,x.o)(),a=(n.data,n.fetchData),o=n.toast,d=n.showToast;n.hideToast;var c=(0,g.useState)(!1),u=c[0],Z=c[1],w=(0,g.useState)([]),j=w[0],v=w[1],C=(0,g.useState)([]),S=C[0],T=C[1],_=(0,g.useState)(t),M=_[0],P=_[1],N=(0,g.useState)(null),E=N[0],I=N[1];(0,g.useEffect)(function(){console.log("Setting up socket connection.");var e=(0,b.ZP)("http://localhost:5000");return e.on("triggered-message-updated",function(e){console.log(e),P(M.map(function(t){return t.messageNumberId===e.messageNumberId?e:t}))}),e.on("disconnect",function(){console.log("Disconnected from the server")}),function(){e.disconnect()}},[M]),(0,g.useEffect)(function(){a()},[]),(0,g.useEffect)(function(){v(M.map(function(e){return e.active})),T(M.map(function(e){return e.active}))},[M]);var O=function(e,t){var n=(0,i.Z)(S);n[e]=t,T(n),Z(!j.every(function(e,t){return e===n[t]}))};function k(){return(k=(0,s.Z)(r().mark(function e(){var t;return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={updatedTriggeredMessages:M.map(function(e,t){return V(V({},e),{},{active:S[t]})})},console.log("Sending updated data: ".concat(JSON.stringify(t))),e.prev=3,e.next=6,fetch("http://localhost:5000/update-triggered-messages",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 6:e.sent.ok?(console.log("Successfully updated messages!"),d("Successfully updated messages!","success"),v(S),Z(!1)):(console.log("Failed to update messages."),d("Failed to update messages.","error")),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.error("Error updating messages:",e.t0),d("Error updating messages.","error");case 14:case"end":return e.stop()}},e,null,[[3,10]])}))).apply(this,arguments)}return console.log("Store Data:",x.o.getState()),console.log(M),(0,y.jsxs)(q,{children:[(0,y.jsx)(f.M,{children:u&&(0,y.jsx)(m.Z,{onSave:function(){return k.apply(this,arguments)},onCancel:function(){T((0,i.Z)(j)),Z(!1)}},"bottom-save-notice")}),(0,y.jsx)(f.M,{children:o.visible&&(0,y.jsx)(h.Z,{},"toast")}),(0,y.jsx)(p.Z,{}),(0,y.jsx)(B,{children:(0,y.jsx)(l.Z,{text:"Messages"})}),(0,y.jsx)(F,{children:M.map(function(e,t){var n=e.messageNumberId,a=e.messageTitle,s=e.messageSubtitle,i=e.textMessageDefaultTextStart,o=e.textMessageCustomText,r=e.textMessageDefaultTextEnd1,l=e.textMessageDefaultTextEnd2;return e.active,(0,y.jsx)(X,{index:t,messageNumberId:n,messageTitle:a,messageSubtitle:s,textMessageDefaultTextStart:i,textMessageCustomText:o,textMessageDefaultTextEnd1:r,textMessageDefaultTextEnd2:l,active:S[t],onTriggeredMessageToggleChange:O,originalTriggeredMessageValue:j[t],editingIndex:E,setEditingIndex:I,hasPendingMessageChanges:u},n)})})]})}},4755:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/messages",function(){return n(3324)}])}},function(e){e.O(0,[553,49,774,888,179],function(){return e(e.s=4755)}),_N_E=e.O()}]);