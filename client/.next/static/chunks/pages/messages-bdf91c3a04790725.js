(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[313],{3324:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return F},default:function(){return A}});var a=n(9499),s=n(29),i=n(6687),o=n(7794),r=n.n(o),l=n(711),c=n(508),d=n(8338),u=n(2287),g=n(7294),p=n(7711),f=n(8187),x=n(1526),h=n(566),m=n(7517),b=n(3920),Z=n(6552),y=n(5893),w=c.ZP.div.withConfig({displayName:"Textarea__TextareaContainer",componentId:"sc-14wqn48-0"})(["@media ","{display:flex;width:100%;flex-direction:column;align-items:flex-start;gap:8px;}"],d.Z.XS),j=c.ZP.label.withConfig({displayName:"Textarea__TextareaLabel",componentId:"sc-14wqn48-1"})(["@media ","{display:flex;flex-direction:row;gap:4px;font-size:16px;font-weight:400;line-height:19px;color:",";}"],d.Z.XS,u.Z.neutral700),v=c.ZP.span.withConfig({displayName:"Textarea__RequiredAsterisk",componentId:"sc-14wqn48-2"})(["@media ","{color:",";}"],d.Z.XS,u.Z.error500),T=c.ZP.textarea.withConfig({displayName:"Textarea__TextareaTextarea",componentId:"sc-14wqn48-3"})(["@media ","{display:flex;height:100px;padding:12px;box-sizing:border-box;align-items:flex-start;align-self:stretch;border-radius:8px;background:",";color:",";border:none;outline:none;&:focus{border:1px solid ",";color:",";}&::placeholder{color:",";}}"],d.Z.XS,u.Z.neutral100,u.Z.neutral400,u.Z.primary400,u.Z.primary400,u.Z.neutral300),S=g.forwardRef(function(e,t){var n=e.label,a=e.value,s=e.onChange,i=e.required,o=e.placeholder,r=e.disabled;return(0,y.jsxs)(w,{children:[n&&(0,y.jsxs)(j,{children:[i&&(0,y.jsx)(v,{children:"*"}),n]}),(0,y.jsx)(T,{value:a,onChange:function(e){return s(e.target.value)},required:i,placeholder:o,disabled:r,ref:t})]})});S.displayName="Textarea";var C=n(5030),_=c.ZP.div.withConfig({displayName:"MessageCell__MessageCellContainer",componentId:"sc-1gn6bj9-0"})(["@media ","{display:flex;width:100%;flex-direction:column;align-items:flex-start;gap:20px;}"],d.Z.XS),M=c.ZP.div.withConfig({displayName:"MessageCell__MessageTop",componentId:"sc-1gn6bj9-1"})(["@media ","{display:flex;gap:24px;width:100%;}"],d.Z.XS),N=c.ZP.div.withConfig({displayName:"MessageCell__HeadingAndSubhead",componentId:"sc-1gn6bj9-2"})(["@media ","{display:flex;flex-direction:column;gap:8px;flex:1 0 0;h4{font-size:24px;font-weight:800;line-height:29px;color:",";}p{font-size:16px;font-weight:500;line-height:19px;color:",";}}@media ","{h4{font-size:32px;font-weight:800;line-height:39px;color:",";}p{font-size:20px;font-weight:500;line-height:24px;color:",";}}"],d.Z.XS,u.Z.neutral600,u.Z.neutral400,d.Z.L,u.Z.neutral600,u.Z.neutral400),P=c.ZP.div.withConfig({displayName:"MessageCell__MessageContainer",componentId:"sc-1gn6bj9-3"})(["@media ","{display:flex;padding:16px;flex-direction:column;gap:16px;border-radius:16px;background:",";width:100%;box-sizing:border-box;}@media ","{padding:20px;}"],d.Z.XS,u.Z.neutral200,d.Z.L),E=c.ZP.div.withConfig({displayName:"MessageCell__TextareaAndButtons",componentId:"sc-1gn6bj9-4"})(["@media ","{display:flex;flex-direction:column;align-items:flex-start;gap:16px;align-self:stretch;flex:1 0 0;}"],d.Z.XS),O=c.ZP.div.withConfig({displayName:"MessageCell__BottomButtons",componentId:"sc-1gn6bj9-5"})(["@media ","{display:flex;flex-direction:column;gap:16px;width:100%;}@media ","{flex-direction:row;gap:12px;width:auto;}"],d.Z.XS,d.Z.S),k=c.ZP.div.withConfig({displayName:"MessageCell__ButtonContainer",componentId:"sc-1gn6bj9-6"})(["@media ","{display:flex;width:100%;}@media ","{width:auto;}"],d.Z.XS,d.Z.S),I=c.ZP.div.withConfig({displayName:"MessageCell__TextMessageTop",componentId:"sc-1gn6bj9-7"})(["@media ","{display:flex;padding:0;margin:0;p{color:",";font-size:16px;font-weight:500;line-height:26px;}}"],d.Z.XS,u.Z.neutral700),D=c.ZP.div.withConfig({displayName:"MessageCell__TextMessageBottom",componentId:"sc-1gn6bj9-8"})(["@media ","{display:flex;flex-direction:column;padding:0;margin:0;p{color:",";font-size:16px;font-weight:500;line-height:26px;}}"],d.Z.XS,u.Z.neutral700),X=function(e){var t,n=e.messageNumberId,a=e.messageTitle,i=e.messageSubtitle,o=e.textMessageDefaultTextStart,c=e.textMessageCustomText,d=e.textMessageDefaultTextEnd1,u=e.textMessageDefaultTextEnd2,p=e.active,x=e.onTriggeredMessageToggleChange,h=e.originalTriggeredMessageValue,m=e.index,b=(0,g.useRef)(null),w=(0,g.useState)(!1),j=w[0],v=w[1],T=(0,g.useState)(c),X=T[0],z=T[1],V=(0,g.useState)(X),q=V[0],B=V[1],F=(0,g.useState)(p),A=F[0],L=F[1],J=(0,f.o)(function(e){return{showToast:e.showToast}}).showToast;(0,g.useEffect)(function(){L(p)},[p]),(0,g.useEffect)(function(){L(h),console.log("isActive state reset to:",h)},[h]),(0,g.useEffect)(function(){if(j){var e;null===(e=b.current)||void 0===e||e.focus()}},[j]);var R=(t=(0,s.Z)(r().mark(function e(){var t,a;return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={triggeredMessageDetails:{customText:q,triggeredMessageId:n},user:f.o.getState().data},e.prev=2,e.next=5,fetch("http://localhost:5000/update-triggered-message-content",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 5:if(!(a=e.sent).ok){e.next=15;break}return e.next=9,a.json();case 9:e.sent,J("Message updated successfully!","success"),z(q),v(!1),e.next=16;break;case 15:J("Failed to update message.","error");case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),J("Error: Something went wrong!","error");case 21:case"end":return e.stop()}},e,null,[[2,18]])})),function(){return t.apply(this,arguments)});return(0,y.jsxs)(_,{children:[(0,y.jsxs)(M,{children:[(0,y.jsxs)(N,{children:[(0,y.jsx)("h4",{children:a}),(0,y.jsx)(l.Z,{text:i})]}),(0,y.jsx)(C.Z,{active:A,onChange:function(e){L(e),x(m,e)}})]}),(0,y.jsxs)(P,{children:[(0,y.jsx)(I,{children:(0,y.jsx)(l.Z,{text:o})}),(0,y.jsxs)(E,{children:[(0,y.jsx)(S,{value:q,onChange:function(e){return B(e)},disabled:!j,ref:b}),(0,y.jsxs)(D,{children:[(0,y.jsx)(l.Z,{text:d}),(0,y.jsx)(l.Z,{text:u})]}),j?(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(O,{children:[(0,y.jsx)(k,{children:(0,y.jsx)(Z.Z,{buttonTypeVariant:"neutral",sizeVariant:"large",label:"Cancel",buttonWidthVariant:"fill",onClick:function(){B(X),v(!1)}})}),(0,y.jsx)(k,{children:(0,y.jsx)(Z.Z,{buttonTypeVariant:"primary",sizeVariant:"large",label:"Save",buttonWidthVariant:"fill",onClick:function(){z(q),v(!1),R()}})})]})}):(0,y.jsx)(k,{children:(0,y.jsx)(Z.Z,{buttonTypeVariant:"secondary",sizeVariant:"large",label:"Edit Custom Text",buttonWidthVariant:"fill",onClick:function(){v(!0)}})})]})]})]})};function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach(function(t){(0,a.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var q=c.ZP.div.withConfig({displayName:"messages__FlexDiv2",componentId:"sc-q8sudu-0"})(["@media ","{display:flex;gap:40px;flex-direction:column;padding:24px 16px;width:100vw;box-sizing:border-box;background:",";}"],d.Z.XS,u.Z.primary100),B=c.ZP.div.withConfig({displayName:"messages__MessagesPageTitle",componentId:"sc-q8sudu-1"})(["@media ","{display:flex;color:",";p{font-size:32px;line-height:39px;font-weight:800;}}@media ","{color:",";p{font-size:40px;line-height:48px;}}@media ","{color:",";p{font-size:48px;line-height:58px;}}"],d.Z.XS,u.Z.neutral700,d.Z.S,u.Z.neutral700,d.Z.L,u.Z.neutral700),F=!0,A=function(e){var t=e.triggeredMessagesData,n=(0,f.o)(),a=(n.data,n.fetchData),o=n.toast,c=n.showToast;n.hideToast;var d=(0,g.useState)(!1),u=d[0],Z=d[1],w=(0,g.useState)([]),j=w[0],v=w[1],T=(0,g.useState)([]),S=T[0],C=T[1],_=(0,g.useState)(t),M=_[0],N=_[1];(0,g.useEffect)(function(){console.log("Setting up socket connection.");var e=(0,b.ZP)("http://localhost:5000");return e.on("triggered-message-updated",function(e){console.log(e),N(M.map(function(t){return t.messageNumberId===e.messageNumberId?e:t}))}),e.on("disconnect",function(){console.log("Disconnected from the server")}),function(){e.disconnect()}},[M]),(0,g.useEffect)(function(){a()},[]),(0,g.useEffect)(function(){v(M.map(function(e){return e.active})),C(M.map(function(e){return e.active}))},[M]);var P=function(e,t){var n=(0,i.Z)(S);n[e]=t,C(n),Z(!j.every(function(e,t){return e===n[t]}))};function E(){return(E=(0,s.Z)(r().mark(function e(){var t;return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={updatedTriggeredMessages:M.map(function(e,t){return V(V({},e),{},{active:S[t]})})},console.log("Sending updated data: ".concat(JSON.stringify(t))),e.prev=3,e.next=6,fetch("http://localhost:5000/update-triggered-messages",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 6:e.sent.ok?(console.log("Successfully updated messages!"),c("Successfully updated messages!","success"),v(S),Z(!1)):(console.log("Failed to update messages."),c("Failed to update messages.","error")),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.error("Error updating messages:",e.t0),c("Error updating messages.","error");case 14:case"end":return e.stop()}},e,null,[[3,10]])}))).apply(this,arguments)}return console.log("Store Data:",f.o.getState()),console.log(M),(0,y.jsxs)(q,{children:[(0,y.jsx)(x.M,{children:u&&(0,y.jsx)(m.Z,{onSave:function(){return E.apply(this,arguments)},onCancel:function(){C((0,i.Z)(j)),Z(!1)}},"bottom-save-notice")}),(0,y.jsx)(x.M,{children:o.visible&&(0,y.jsx)(h.Z,{},"toast")}),(0,y.jsx)(p.Z,{}),(0,y.jsx)(B,{children:(0,y.jsx)(l.Z,{text:"Messages"})}),M.map(function(e,t){var n=e.messageNumberId,a=e.messageTitle,s=e.messageSubtitle,i=e.textMessageDefaultTextStart,o=e.textMessageCustomText,r=e.textMessageDefaultTextEnd1,l=e.textMessageDefaultTextEnd2;return e.active,(0,y.jsx)(X,{index:t,messageNumberId:n,messageTitle:a,messageSubtitle:s,textMessageDefaultTextStart:i,textMessageCustomText:o,textMessageDefaultTextEnd1:r,textMessageDefaultTextEnd2:l,active:S[t],onTriggeredMessageToggleChange:P,originalTriggeredMessageValue:j[t]},n)})]})}},4755:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/messages",function(){return n(3324)}])}},function(e){e.O(0,[553,49,774,888,179],function(){return e(e.s=4755)}),_N_E=e.O()}]);